#!/usr/bin/env ruby
require 'rubygems' unless defined?(Gem)
$LOAD_PATH.unshift(File.expand_path("../lib", File.dirname(__FILE__)))
require 'wukong/script'

Settings.use :commandline

Settings.resolve!

Settings.script_file ||= Settings.rest.pop

case File.basename($0)
when 'wu-map' then Settings.mode = :mapper
when 'wu-red' then Settings.mode = :reducer
end

Wukong.from_file(Settings.script_file)

Wukong::Script.new(Settings).run
